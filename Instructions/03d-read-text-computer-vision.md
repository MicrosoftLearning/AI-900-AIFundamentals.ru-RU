---
lab:
  title: Знакомство с оптическим распознаванием символов
---

# Знакомство с оптическим распознаванием символов

> **Примечание**. Для выполнения этого задания вам потребуется [подписка Azure](https://azure.microsoft.com/free?azure-portal=true), в которой у вас есть административный доступ.

Основная задача системы компьютерного зрения состоит в обнаружении и распознавании текста на изображении. Такой тип обработки часто называют *оптическим распознаванием символов* (OCR). API чтения Майкрософт предоставляет доступ к возможностям распознавания текста. 

Чтобы протестировать возможности API чтения, мы используем простое приложение командной строки, которое выполняется в Cloud Shell. Те же принципы и функциональные возможности реализованы и в реальных решениях, таких как веб-сайты и приложения для телефонов.

## Использование службы "Визуальное распознавание ИИ Azure" для чтения текста на изображении

**Служба визуального распознавания** ИИ Azure обеспечивает поддержку задач OCR, в том числе:

- API **чтения**, оптимизированный для больших документов. Этот API используется в асинхронном режиме и применим как для печатного, так и для рукописного текста.

## *Создание ресурса служб* ИИ Azure

Службу "Визуальное распознавание ИИ Azure" можно использовать, создав **Компьютерное зрение** ресурс или **ресурс служб** ИИ Azure.

Если вы еще этого не сделали, создайте **ресурс служб** искусственного интеллекта Azure в подписке Azure.

1. На другой вкладке браузера откройте портал Azure по адресу [https://portal.azure.com](https://portal.azure.com?azure-portal=true) и войдите в него, используя свою учетную запись Майкрософт.

1. **Щелкните &65291; Создайте кнопку ресурса** и найдите *службы* ИИ Azure. Выберите **план** **служб** ИИ Azure. Вы перейдете на страницу, чтобы создать ресурс служб искусственного интеллекта Azure. Настройте его с помощью следующих параметров:
    - **Подписка**: *ваша подписка Azure*.
    - **Группа ресурсов**: *выберите существующую или создайте новую группу ресурсов с уникальным именем*.
    - **Регион**: *выберите любой доступный регион*.
    - **Имя**: *укажите уникальное имя*.
    - **Ценовая категория**: Стандартный S0.
    - **Устанавливая этот флажок, я подтверждаю, что мною прочитаны все приведенные ниже условия и я понимаю их**: флажок установлен.

1. Проверьте и создайте ресурс, а затем дождитесь завершения развертывания. Затем перейдите к развернутому ресурсу.

1. Просмотрите страницу "Ключи" и " **Конечная точка** " для ресурса служб искусственного интеллекта Azure. Для подключения из клиентских приложений потребуются конечная точка и ключи.

## Запуск Cloud Shell

Чтобы протестировать возможности службы Компьютерного зрения, мы используем простое приложение командной строки, которое выполняется в Cloud Shell в Azure.

1. На портале Azure нажмите кнопку **[>_]** (*Cloud Shell*) в верхней части страницы справа от поля поиска. В нижней части портала откроется панель Cloud Shell. 

    ![Запустите Cloud Shell, нажав значок справа от верхнего поля поиска.](media/read-text-computer-vision/powershell-portal-guide-1.png)

1. При первом запуске Cloud Shell вам может быть предложено выбрать тип оболочки, которую вы будете использовать (*Bash* или *PowerShell*). Выберите **PowerShell**. В противном случае пропустите этот шаг.  

1. Если вам будет предложено создать хранилище для Cloud Shell, укажите свою подписку и нажмите **Создать хранилище**. Затем подождите минуту, пока хранилище не будет создано.

    ![Нажмите "Подтвердить", чтобы создать хранилище.](media/read-text-computer-vision/powershell-portal-guide-2.png)

1. Убедитесь, что тип оболочки в левом верхнем углу панели Cloud Shell изменился на *PowerShell*. Если там указана оболочка *Bash*, выберите *PowerShell* из раскрывающегося меню.

    ![Как найти раскрывающееся меню слева для переключения на PowerShell](media/read-text-computer-vision/powershell-portal-guide-3.png) 

1. Дождитесь запуска PowerShell. На портале Azure должен отобразиться следующий экран:  

    ![Дождитесь запуска PowerShell.](media/read-text-computer-vision/powershell-prompt.png) 

## Настройка и запуск клиентского приложения

Теперь, когда у вас есть пользовательская модель, можно запустить простое клиентское приложение, использующее службу OCR.

1. В командной оболочке введите следующую команду, чтобы скачать пример приложения и сохранить его в папку ai-900.

    ```PowerShell
    git clone https://github.com/MicrosoftLearning/AI-900-AIFundamentals ai-900
    ```

    >**Совет**. Если вы уже использовали эту команду в другом задании для клонирования репозитория *ai-900*, этот шаг можно пропустить.

1. Файлы скачиваются в папку **ai-900**. Теперь нам нужно просмотреть все файлы в хранилище Cloud Shell и поработать с ними. Введите в оболочке следующую команду:

    ```PowerShell
    code .
    ```

    Обратите внимание, что откроется редактор, подобный следующему: 

    ![Редактор кода.](media/read-text-computer-vision/powershell-portal-guide-4.png)

1. На панели **Файлы** слева разверните узел **ai-900** и выберите файл **ocr.ps1**. Этот файл содержит код, который использует службу Компьютерного зрения для обнаружения и анализа текста на изображении, как показано ниже:

    ![Редактор, содержащий код для анализа текста на изображениях.](media/read-text-computer-vision/ocr-code.png)

1. Не беспокойтесь слишком много о деталях кода, важно, чтобы он нуждались в URL-адресе конечной точки и любом из ключей для ресурса служб искусственного интеллекта Azure. Скопируйте их со страницы **Ключи и конечные точки** для своего ресурса с портала Azure и вставьте в редакторе кода, заменив значения заполнителей **YOUR_KEY** и **YOUR_ENDPOINT** соответственно ключом и конечной точкой.

    > **Совет** Вы можете настроить области **Ключи и конечная точка** и **Редактор** на экране с помощью разделительной полосы.

    После того как значения ключа и конечной точки будут вставлены, первые две строки кода должны выглядеть следующим образом:

    ```PowerShell
    $key="1a2b3c4d5e6f7g8h9i0j...."    
    $endpoint="https..."
    ```

1. В правом верхнем углу панели редактора нажмите кнопку **...**, чтобы открыть меню, и выберите **Сохранить**, чтобы сохранить свои изменения. Затем снова откройте меню и выберите пункт **Закрыть редактор**. Теперь, когда вы настроили ключ и конечную точку, вы можете использовать ресурс служб искусственного интеллекта Azure для извлечения текста из изображения.

    Давайте используем API **чтения**. В этом случае у вас есть рекламное изображение вымышленной торговой компании Northwind Trader, который содержит некоторый текст.

    Пример клиентского приложения будет анализировать следующее изображение:

    ![Изображение объявления магазина Northwind Traders.](media/read-text-computer-vision/advert.jpg)

1. В области PowerShell введите следующие команды для запуска кода:

    ```PowerShell
    cd ai-900
    ./ocr.ps1 advert.jpg
    ```

1. Проверьте сведения, обнаруженные на изображении. Текст, обнаруженный на изображении, систематизируется в виде иерархической структуры из областей, строк и слов, и код считывает их для формирования результатов.

    Обратите внимание, что расположение текста обозначается с помощью координат левого верхнего угла, ширины и высоты *ограничивающего прямоугольника*, как показано ниже:

    ![Изображение текста на изображении выделено контуром](media/read-text-computer-vision/lab-05-bounding-boxes.png)

1. Теперь давайте попробуем еще одно изображение:

    ![Изображение печатного письма.](media/read-text-computer-vision/letter.jpg)

    Чтобы проанализировать второе изображение, введите следующую команду:

    ```PowerShell
    ./ocr.ps1 letter.jpg
    ```

1. Проверьте результаты анализа для второго изображения. Приложение также должно возвращать текст с ограничивающими прямоугольниками.

## Подробнее

В этом простом приложении демонстрируются лишь некоторые возможности оптического распознавания текста службы Компьютерного зрения. Дополнительные сведения о том, что можно сделать с помощью этой службы, см. на [странице о технологии OCR](https://docs.microsoft.com/azure/cognitive-services/computer-vision/overview-ocr).
