---
lab:
  title: Изучение распознавания лиц
---

# Изучение распознавания лиц

> **Примечание**. Для выполнения этого задания вам потребуется [подписка Azure](https://azure.microsoft.com/free?azure-portal=true), в которой у вас есть административный доступ.

Решениям в области компьютерного зрения для распознавания человеческих лиц часто требуется система искусственного интеллекта (ИИ). Допустим, некая розничная компания под названием "Нортвинд Трейдерс" хочет узнавать местонахождение покупателей в магазине, чтобы улучшить их обслуживание. Один из способов решения этой задачи — определить наличие лиц на изображениях, и, если лица есть, установить координаты ограничивающих прямоугольников вокруг этих лиц.

Чтобы протестировать возможности службы Распознавания лиц, мы используем простое приложение командной строки, которое выполняется в Cloud Shell. Те же принципы и функциональные возможности реализованы и в реальных решениях, таких как веб-сайты и приложения для телефонов.

## Создание ресурса *API распознавания лиц*

Службу распознавания лиц можно использовать, создав ресурс **распознавания лиц** .

Если вы еще не сделали этого, создайте ресурс **API распознавания лиц** в подписке Azure.

1. На другой вкладке браузера откройте портал Azure по адресу [https://portal.azure.com](https://portal.azure.com?azure-portal=true) и войдите в него, используя свою учетную запись Майкрософт.

1. Нажмите ** кнопку&#65291;Создать ресурс** , выполните поиск по запросу *Face* и создайте ресурс **Распознавание лиц** со следующими параметрами:
    - **Подписка**: *ваша подписка Azure*.
    - **Группа ресурсов**: *выберите существующую или создайте новую группу ресурсов с уникальным именем*.
    - **Регион**: *выберите любой доступный регион*.
    - **Имя**: *укажите уникальное имя*.
    - **Ценовая категория**: Бесплатный F0.

1. Проверьте и создайте ресурс, а затем дождитесь завершения развертывания. Затем перейдите к развернутому ресурсу.

1. Просмотрите страницу **Ключи и конечная точка** для ресурса распознавания лиц. Для подключения из клиентских приложений потребуются конечная точка и ключи.

## Запуск Cloud Shell

Чтобы протестировать возможности службы Распознавания лиц, мы используем простое приложение командной строки, которое выполняется в Cloud Shell в Azure. 

1. На портале Azure нажмите кнопку **[>_]** (*Cloud Shell*) в верхней части страницы справа от поля поиска. В нижней части портала откроется панель Cloud Shell. 

    ![Запустите Cloud Shell, нажав значок справа от верхнего поля поиска.](media/create-face-solutions/powershell-portal-guide-1.png)

1. При первом запуске Cloud Shell вам может быть предложено выбрать тип оболочки, которую вы будете использовать (*Bash* или *PowerShell*). Выберите ссылку **PowerShell**. В противном случае пропустите этот шаг.  

1. Если вам будет предложено создать хранилище для Cloud Shell, укажите свою подписку и нажмите **Создать хранилище**. Затем подождите минуту, пока хранилище не будет создано.

    ![Нажмите "Подтвердить", чтобы создать хранилище.](media/create-face-solutions/powershell-portal-guide-2.png)       

1. Убедитесь, что тип оболочки в левом верхнем углу панели Cloud Shell изменился на *PowerShell*. Если там указана оболочка *Bash*, выберите *PowerShell* из раскрывающегося меню.

    ![Как найти раскрывающееся меню слева для переключения на PowerShell](media/create-face-solutions/powershell-portal-guide-3.png) 

1. Дождитесь запуска PowerShell. На портале Azure должен отобразиться следующий экран:  

    ![Дождитесь запуска PowerShell.](media/create-face-solutions/powershell-prompt.png)

## Настройка и запуск клиентского приложения

Теперь, когда у вас есть пользовательская модель, можно запустить простое клиентское приложение, использующее службу Распознавания лиц.

1. В командной оболочке введите следующую команду, чтобы скачать пример приложения и сохранить его в папку ai-900.

    ```PowerShell
    git clone https://github.com/MicrosoftLearning/AI-900-AIFundamentals ai-900
    ```

    > **Совет**. Если вы уже использовали эту команду в другом задании для клонирования репозитория *ai-900*, этот шаг можно пропустить.

1. Файлы скачиваются в папку **ai-900**. Теперь нам нужно просмотреть все файлы в хранилище Cloud Shell и поработать с ними. Введите в оболочке следующую команду:

     ```PowerShell
    code .
    ```

    Обратите внимание, что откроется редактор, подобный следующему: 

    ![Редактор кода.](media/create-face-solutions/powershell-portal-guide-4.png) 

1. На панели **Файлы** слева разверните узел **ai-900** и выберите файл **find-faces.ps1**. Этот файл содержит код, который использует службу Распознавания лиц для обнаружения и анализа лиц на изображении, как показано ниже:

    ![Редактор, содержащий код поиска лиц на изображении](media/create-face-solutions/find-faces-code.png)

1. Не беспокойтесь о деталях кода, важно, чтобы ему нужен URL-адрес конечной точки и любой из ключей для ресурса распознавания лиц. Скопируйте их со страницы **Ключи и конечные точки** для своего ресурса с портала Azure и вставьте в редакторе кода, заменив значения заполнителей **YOUR_KEY** и **YOUR_ENDPOINT** соответственно ключом и конечной точкой.

    > **Совет** Вы можете настроить области **Ключи и конечная точка** и **Редактор** на экране с помощью разделительной полосы.

    После того как значения ключа и конечной точки будут вставлены, первые две строки кода должны выглядеть следующим образом:

    ```PowerShell
    $key="1a2b3c4d5e6f7g8h9i0j...."    
    $endpoint="https..."
    ```

1. В правом верхнем углу панели редактора нажмите кнопку **...**, чтобы открыть меню, и выберите **Сохранить**, чтобы сохранить свои изменения. Затем снова откройте меню и выберите пункт **Закрыть редактор**.

    Пример клиентского приложения будет использовать службу Распознавания лиц для анализа следующего изображения, полученного камерой в магазине Northwind Trader:

    ![Изображение родителя, снимающего ребенка в магазине на камеру сотового телефона](media/create-face-solutions/store-camera-1.jpg)

1. В области PowerShell введите следующие команды для запуска кода:

    ```PowerShell
    cd ai-900
    ./find-faces.ps1 store-camera-1.jpg
    ```

1. Просмотрите возвращаемые сведения, в которые входят данные о местонахождении лица на изображении. Местонахождение лица обозначают координаты левого верхнего угла, а также ширина и высота *ограничивающего прямоугольника*, как показано ниже:

    ![Изображение человека, лицо которого обведено](media/create-face-solutions/store-camera-1-face.jpg)

    >**Примечание** Возможности службы распознавания лиц, возвращающие персональные данные, ограничены. Дополнительные сведения см. в разделе https://azure.microsoft.com/blog/responsible-ai-investments-and-safeguards-for-facial-recognition/.

1. Теперь давайте попробуем еще одно изображение:

    ![Изображение человека с корзиной для покупок](media/create-face-solutions/store-camera-2.jpg)

    Чтобы проанализировать второе изображение, введите следующую команду:

    ```PowerShell
    ./find-faces.ps1 store-camera-2.jpg
    ```

1. Проверьте результаты анализа лиц для второго изображения.

1. Попробуем еще одно:

    ![Изображение человека с тележкой для покупок](media/create-face-solutions/store-camera-3.jpg)

    Чтобы проанализировать третье изображение, введите следующую команду:

    ```PowerShell
    ./find-faces.ps1 store-camera-3.jpg
    ```

1. Проверьте результаты анализа лиц для третьего изображения.

## Дополнительные сведения

В этом простом приложении демонстрируются лишь некоторые возможности службы Распознавания лиц. Дополнительные сведения о том, что можно сделать с помощью этой службы, см. на [странице API распознавания лиц](https://azure.microsoft.com/en-us/products/cognitive-services/vision-services).
